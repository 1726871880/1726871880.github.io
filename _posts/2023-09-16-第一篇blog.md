---
layout: post
title:  线性模型中r、R^2、eta^2、F、f、f^2的关系
date:   2023-09-16 16:40:16
description: 附带不算太严谨的证明
tags: 
categories: 
---

首先，决定系数 $R^2$ 实际上就是样本皮尔逊相关系数 $r$ 的平方。根据 $r$ 的计算公式很容易得到：

$$
\begin{eqnarray}
r^2 & = & \left[ \frac{Cov(X, Y)}{\sigma(x)\sigma(y)}\right]^2
& = & \frac{\left[ \sum_{i=1}^{n}(y_i-\bar{y})(x_i-\bar{x}) \right]^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2\sum_{i=1}^{n}(x_i-\bar{x})^2} 
\end{eqnarray}
\tag{1.1}
$$

单独拿出分子:

$$
\begin{eqnarray}
&& [\sum_{i=1}^{n}(y_i-\bar{y})\sum_{i=1}^{n}(x_i-\bar{x})]^2\\
& = & [\sum_{i=1}^{n}[(y_i-\hat{y_i})+(\hat{y_i}-\bar{y})]\sum_{i=1}^{n}(x_i-\bar{x})]^2\\
& = & [\sum_{i=1}^{n}(y_i-\hat{y_i})(x_i-\bar{x})+ \sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2
\end{eqnarray}
\tag{1.2}
$$

单独拿出括号中的左半部分 $\sum_{i=1}^{n}(y_i-\hat{y_i})(x_i-\bar{x})$，我们知道回归的基本表达是 $\hat{y_i} = b_0 + b_1 x_i$，代入得到：

$$
\begin{eqnarray}
&& \sum_{i=1}^{n}(y_i-\hat{y})(x_i-\bar{x})\\
& = & \frac{1}{b_1}\sum_{i=1}^{n}(y_i-\hat{y_i})[(b_1 x_i+b_0)-(b_1\bar{x}+b_0)]\\
& = & \frac{1}{b_1}\sum_{i=1}^{n}(y_i-\hat{y_i})(\hat{y_i}-\bar{y})
\end{eqnarray}
\tag{1.3}
$$

根据回归分析的正交假定可以得到 $Cov(\hat{Y},\varepsilon) = 0$，即 $\sum_{i=1}^{n}(y_i-\hat{y})(\hat{y}-\bar{y}) = 0$，因此(1.2)只剩下 $[\sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2$。然后同理将 $y = b_0 + b_1x$ 代入:

$$
\begin{eqnarray}
&& [\sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2\\
& = & \sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x}) \sum_{i=1}^{n}(\hat{y}-\bar{y})(x_i-\bar{x})\\
& = & \frac{1}{b} \sum_{i=1}^{n} [(\hat{y_i}-\bar{y})]^2 b\sum_{i=1}^{n}[(x_i-\bar{x})]^2 \\
& = & \sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2 \sum_{i=1}^{n} (x_i-\bar{x})^2
\end{eqnarray}
\tag{1.4}
$$

那么(1.1)变为：

$$
\begin{eqnarray}
&& \frac{\sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2 \sum_{i=1}^{n} (x_i-\bar{x})^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2\sum_{i=1}^{n}(x_i-\bar{x})^2}
& = & \frac{\sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2}
& = & \frac{SSR}{SST}
& = & R^2
\end{eqnarray}
\tag{1.5}
$$

