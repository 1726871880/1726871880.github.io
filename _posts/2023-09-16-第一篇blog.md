---
layout: post
title:  线性模型中$$r$$、$$R^2$$、$$eta^2$$、$$F$$、$$f$$、$$f^2$$的关系
date:   2023-09-16 16:40:16
description: 附带不算太严谨的证明
tags: 心理学
categories: 
---

决定系数 $$R^2$$ 原本的含义是拟合优度。

具体来讲，在回归分析中，我们将全部观测值 $$y_i$$ 偏离均值 $$\bar{y}$$ 的离差平方和记作SST(Sum of Squares Total)。其中包含了观测值 $$y_i$$ 偏离回归估计值 $$\hat{y_i}$$ 离差平方和SSE(Sum of Squares Error)，以及估计值 $$\hat{y_i}$$ 偏离平均值 $$\bar{y} 的离差平方和SSR(Sum of Squares Regression)。

$$
\begin{eqnarray}
SST & = & \sum_{i=1}^{n} (y_i-\bar{y})^2\\
& = & \sum_{i=1}^{n} [(\hat{y_i}-\bar{y})+(y_i-\hat{y})]^2\\
& = & \sum_{i=1}^{n} [(\hat{y_i}-\bar{y})^2+(y_i-\hat{y})^2+2(\hat{y_i}-\bar{y})(y_i-\hat{y})]\\
\end{eqnarray}
$$

回归模型的外生性假设要求误差项与解释变量不相关，即 $$Cov(X,\varepsilon) = 0$$，我们知道回归的基本表达是 $$\hat{y_i} = b_0 + b_1 x_i$$，所以$$Cov(\hat{Y},\varepsilon) = 0$$。所以：

$$
\begin{eqnarray}
\sum_{i=1}^{n} [(\hat{y_i}-\bar{y})^2+(y_i-\hat{y})^2+2(\hat{y_i}-\bar{y})(y_i-\hat{y})] = \sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2+ \sum_{i=1}^{n} (y_i-\hat{y})^2 = SSR + SSE
\end{eqnarray}
$$

SSE代表回归方程无法解释的变异，SSR代表回归方程可以解释的变异。SSR/SST，即可解释变异占总变异的比例，代表了回归方程的拟合优度，即 $$R^2$$。决定系数 $$R^2$$ 实际上就是样本皮尔逊相关系数 $$r$$ 的平方。根据 $$r$$ 的计算公式很容易得到：

$$
\begin{eqnarray}
r^2 & = & \left[ \frac{Cov(X, Y)}{\sigma(x)\sigma(y)}\right]^2
& = & \frac{\left[ \sum_{i=1}^{n}(y_i-\bar{y})(x_i-\bar{x}) \right]^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2\sum_{i=1}^{n}(x_i-\bar{x})^2} 
\end{eqnarray}
$$

单独拿出分子:

$$
\begin{eqnarray}
&& [\sum_{i=1}^{n}(y_i-\bar{y})(x_i-\bar{x})]^2\\
& = & [\sum_{i=1}^{n}[(y_i-\hat{y_i})+(\hat{y_i}-\bar{y})](x_i-\bar{x})]^2\\
& = & [\sum_{i=1}^{n}(y_i-\hat{y_i})(x_i-\bar{x})+ \sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2
\end{eqnarray}
$$

单独拿出括号中的左半部分 $$\sum_{i=1}^{n}(y_i-\hat{y_i})(x_i-\bar{x})$$，我们知道回归的基本表达是 $$\hat{y_i} = b_0 + b_1 x_i$$，代入得到：

$$
\begin{eqnarray}
&& \sum_{i=1}^{n}(y_i-\hat{y})(x_i-\bar{x})\\
& = & \frac{1}{b_1}\sum_{i=1}^{n}(y_i-\hat{y_i})[(b_1 x_i+b_0)-(b_1\bar{x}+b_0)]\\
& = & \frac{1}{b_1}\sum_{i=1}^{n}(y_i-\hat{y_i})(\hat{y_i}-\bar{y})
\end{eqnarray}
$$

与 (4) 同理，根据回归分析的外生性假设，(11) 可以直接消掉，(8) 只剩下 $$[\sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2$$。然后同理将 $$y = b_0 + b_1x$$ 代入:

$$
\begin{eqnarray}
&& [\sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x})]^2\\
& = & \sum_{i=1}^{n}(\hat{y_i}-\bar{y})(x_i-\bar{x}) \sum_{i=1}^{n}(\hat{y}-\bar{y})(x_i-\bar{x})\\
& = & \frac{1}{b} \sum_{i=1}^{n} [(\hat{y_i}-\bar{y})]^2 b\sum_{i=1}^{n}[(x_i-\bar{x})]^2 \\
& = & \sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2 \sum_{i=1}^{n} (x_i-\bar{x})^2
\end{eqnarray}
$$

那么(5)变为：

$$
\begin{eqnarray}
&& \frac{\sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2 \sum_{i=1}^{n} (x_i-\bar{x})^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2\sum_{i=1}^{n}(x_i-\bar{x})^2}
& = & \frac{\sum_{i=1}^{n} (\hat{y_i}-\bar{y})^2}{\sum_{i=1}^{n}(y_i-\bar{y})^2}
& = & \frac{SSR}{SST}
& = & R^2
\end{eqnarray}
\tag{1.5}
$$

